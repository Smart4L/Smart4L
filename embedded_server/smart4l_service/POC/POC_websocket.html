<!DOCTYPE html>
<html>
<head>
	<title>POC WebSocket</title>
</head>
<body>
	<h1>Affichage temps réel</h1>
	<span id="lastMeasure"></span>


</body>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.3.0/socket.io.js"></script>-->
<script type="text/javascript">
	document.getElementById("lastMeasure").innerHTML = "En attente de données ..."


	// --- SocketIO example ---
	/*const socket = io.connect("http://127.0.0.1:80/measure");

	socket.on('receive_message', function (data) {
		document.getElementById("lastMeasure").innerHTML = data
    });
	*/
    // --- === ---


    let socket = new WebSocket("ws://127.0.0.1:8520");


    socket.onopen = function(e) {
    	alert("[open] Connection established");
    	alert("Sending to server");
    	socket.send(1,2,5);
    };


    socket.onmessage = function(event) {
    	alert(`[message] Data received from server: ${event.data}`);
    };


    socket.onclose = function(event) {
    	if (event.wasClean) {
    		alert(`[close] Connection closed cleanly, code=${event.code} reason=${event.reason}`);
    	} else {
		    // e.g. server process killed or network down
		    // event.code is usually 1006 in this case
		    alert('[close] Connection died');
		}
	};


	socket.onerror = function(error) {
		alert(`[error] ${error.message}`);
	};

</script>
</html>